<!DOCTYPE html>
<html lang="en">
  <head>
        <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Character Sets :: Boost Libraries Documentation</title>
  <link rel="canonical" href="https://antora.cppalliance.org/master/lib/doc/url/grammar/charset.html">
    <link rel="prev" href="rules.html">
    <link rel="next" href="combinators.html">
  <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../_/css/boostlook.css">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/vendor/tabs.css">
    <script>var uiRootPath = '../../_'</script>
<link rel="icon" href="../../_/img/favicons/favicon.ico" type="image/x-icon">
    <!-- Favicon configuration -->
    <link rel="apple-touch-icon" sizes="180x180" href="../../_/img/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../_/img/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../_/img/favicons/favicon-16x16.png">
    <link rel="manifest" href="../../_/img/favicons/site.webmanifest">
    <link rel="shortcut icon" href="../../_/img/favicons/favicon.ico">
  </head>
  <body class="article toc2 toc-left">
    <div class="boostlook">
  <div id="header">
    <div id="toc" class="nav-container toc2" data-component="url" data-version="">
  <aside class="nav">
    <button class="nav-close"></button>
    <div class="panels">
      <div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
      <h3 class="title"><a href="../index.html">Boost.URL</a></h3>
      <ul class="nav-list">
        <ul class="nav-list">
        <li class="" data-depth="1">
            <a class="nav-link" href="../quicklook.html">Quick Look</a>
        </li>
              <li class="" data-depth="1">
            <a class="nav-link" href="../urls/index.html">URLs</a>
        </li>
        <ul class="nav-list">
        <li class="" data-depth="2">
            <a class="nav-link" href="../urls/parsing.html">Parsing</a>
        </li>
              <li class="" data-depth="2">
            <a class="nav-link" href="../urls/containers.html">Containers</a>
        </li>
              <li class="" data-depth="2">
            <a class="nav-link" href="../urls/segments.html">Segments</a>
        </li>
              <li class="" data-depth="2">
            <a class="nav-link" href="../urls/params.html">Params</a>
        </li>
              <li class="" data-depth="2">
            <a class="nav-link" href="../urls/normalization.html">Normalization</a>
        </li>
              <li class="" data-depth="2">
            <a class="nav-link" href="../urls/stringtoken.html">String Token</a>
        </li>
              <li class="" data-depth="2">
            <a class="nav-link" href="../urls/percent-encoding.html">Percent Encoding</a>
        </li>
              <li class="" data-depth="2">
            <a class="nav-link" href="../urls/formatting.html">Formatting</a>
        </li>
        </ul>
        <li class="" data-depth="1">
            <a class="nav-link" href="index.html">Customization</a>
        </li>
        <ul class="nav-list">
        <li class="" data-depth="2">
            <a class="nav-link" href="rules.html">Parse Rules</a>
        </li>
              <li class=" is-current-page" data-depth="2">
            <a class="nav-link" href="charset.html">Character Sets</a>
        </li>
              <li class="" data-depth="2">
            <a class="nav-link" href="combinators.html">Compound Rules</a>
        </li>
              <li class="" data-depth="2">
            <a class="nav-link" href="range.html">Ranges</a>
        </li>
              <li class="" data-depth="2">
            <a class="nav-link" href="rfc3986.html">RFC 3986</a>
        </li>
        </ul>
        <li class="" data-depth="1">
            <span class="nav-text">Examples</span>
        </li>
        <ul class="nav-list">
        <li class="" data-depth="2">
            <a class="nav-link" href="../examples/qrcode.html">QR Code</a>
        </li>
              <li class="" data-depth="2">
            <a class="nav-link" href="../examples/finicky.html">Finicky</a>
        </li>
              <li class="" data-depth="2">
            <a class="nav-link" href="../examples/mailto.html">mailto URLs</a>
        </li>
              <li class="" data-depth="2">
            <a class="nav-link" href="../examples/magnet-link.html">Magnet Link</a>
        </li>
              <li class="" data-depth="2">
            <a class="nav-link" href="../examples/file-router.html">File Router</a>
        </li>
              <li class="" data-depth="2">
            <a class="nav-link" href="../examples/router.html">Router</a>
        </li>
              <li class="" data-depth="2">
            <a class="nav-link" href="../examples/sanitize.html">Sanitizing URLs</a>
        </li>
        </ul>
        <li class="" data-depth="1">
            <a class="nav-link" href="../reference.html">Reference</a>
        </li>
              <li class="" data-depth="1">
            <a class="nav-link" href="../HelpCard.html">Help Card</a>
        </li>
        </ul>
  </ul>
  </nav>
</div>
    </div>
  </aside>
</div>
</div>
  <div id="content">
    <article class="doc max-width-reset">
  <div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li>
      <a href="../index.html" aria-label="Home: Boost.URL">
        <svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 -960 960 960" fill="#000000" aria-hidden="true"><path d="M160-120v-480l320-240 320 240v480H560v-280H400v280H160Z"/></svg>
      </a>
    </li>
    <li><a href="index.html">Customization</a></li>
    <li><a href="charset.html">Character Sets</a></li>
  </ul>
</nav>
<div class="spirit-nav">
    <a accesskey="p" href="rules.html"><span class="material-symbols-outlined" title="Previous: Parse Rules">arrow_back</span></a>
    <a accesskey="p" href="index.html"><span class="material-symbols-outlined" title="Up: Customization">arrow_upward</span></a>
    <a accesskey="p" href="combinators.html"><span class="material-symbols-outlined" title="Next: Compound Rules">arrow_forward</span></a>
</div>
</div>
    <h1 class="page">Character Sets</h1>
  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>A <em>character set</em> represents a subset of low-ASCII characters, used as a building block for constructing rules.
The library models them as callable predicates invocable with this equivalent signature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">/// Return true if ch is in the set
bool( char ch ) const noexcept;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>CharSet</em> concept describes the requirements on syntax and semantics for these types.
Here we declare a character set type that includes the horizontal and vertical whitespace characters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">struct ws_chars_t
{
    constexpr bool operator()( char c ) const noexcept
    {
        return c == '\t' || c == ' ' || c == '\r' || c == '\n';
    }
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>The type trait <code><a href="../reference/boost/urls/grammar/is_charset.html" class="xref page">is_charset</a></code> determines if a type meets the requirements:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">static_assert( is_charset&lt; ws_chars_t &gt;::value, "CharSet requirements not met" );</code></pre>
</div>
</div>
<div class="paragraph">
<p>Character sets are always passed as values.
As with rules, we declare an instance of the type for notational convenience.
The <code>constexpr</code> designation is used to make it a zero-cost abstraction:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">constexpr ws_chars_t ws_chars{};</code></pre>
</div>
</div>
<div class="paragraph">
<p>For best results, ensure that user-defined character set types are <code>constexpr</code> constructible.</p>
</div>
<div class="paragraph">
<p>The functions <code><a href="../reference/boost/urls/grammar/find_if.html" class="xref page">find_if</a></code> and <code><a href="../reference/boost/urls/grammar/find_if_not.html" class="xref page">find_if_not</a></code> are used to search a string for the first matching or the first non-matching character from a set.
The example below skips any leading whitespace and then returns everything from the first non-whitespace character to the last non-whitespace character:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">core::string_view get_token( core::string_view s ) noexcept
{
    auto it0 = s.data();
    auto const end = it0 + s.size();

    // find the first non-whitespace character
    it0 = find_if_not( it0, end, ws_chars );

    if( it0 == end )
    {
        // all whitespace or empty string
        return {};
    }

    // find the next whitespace character
    auto it1 = find_if( it0, end, ws_chars );

    // [it0, it1) is the part we want
    return core::string_view( it0, it1 - it0 );
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The function can now be called thusly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">assert( get_token( " \t john-doe\r\n \t jane-doe\r\n") == "john-doe" );</code></pre>
</div>
</div>
<div class="paragraph">
<p>The library provides these often-used character sets:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code><a href="../reference/boost/urls/grammar/alnum_chars.html" class="xref page">alnum_chars</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Contains the uppercase and lowercase letters, and digits.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code><a href="../reference/boost/urls/grammar/alpha_chars.html" class="xref page">alpha_chars</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Contains the uppercase and lowercase letters.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code><a href="../reference/boost/urls/grammar/digit_chars.html" class="xref page">digit_chars</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Contains the decimal digit characters.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code><a href="../reference/boost/urls/grammar/hexdig_chars.html" class="xref page">hexdig_chars</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Contains the uppercase and lowercase hexadecimal
digit characters.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code><a href="../reference/boost/urls/grammar/vchars.html" class="xref page">vchars</a></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Contains the visible characters (i.e. non whitespace).</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Some of the character sets in the library have implementations optimized for the particular character set or optimized in general, often in ways that take advantage of opportunities not available to standard library facilities.
For example, custom code enhancements using Streaming SIMD Extensions 2 (<a href="https://en.wikipedia.org/wiki/SSE2" target="blank_">SSE2</a>), available on all x86 and x64 architectures.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_lut_chars_type"><a class="anchor" href="#_the_lut_chars_type"></a>The lut_chars Type</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code><a href="../reference/boost/urls/grammar/lut_chars.html" class="xref page">lut_chars</a></code> type satisfies the <em>CharSet</em>
requirements and offers an optimized <code>constexpr</code>
implementation which provides enhanced performance and notational convenience for specifying character sets.
Compile-time instances can be constructed from strings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">constexpr lut_chars vowels = "AEIOU" "aeiou";</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can use <code><a href="../reference/boost/urls/grammar/operator_plus.html" class="xref page">operator+</a></code> and <code><a href="../reference/boost/urls/grammar/operator_minus.html" class="xref page">operator-</a></code> notation to add and remove elements from the set at compile time.
For example, sometimes the character 'y' sounds like a vowel:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">constexpr auto vowels_and_y = vowels + 'y' + 'Y';</code></pre>
</div>
</div>
<div class="paragraph">
<p>The type is named after its implementation, which is a lookup table ("lut") of packed bits.
This allows for a variety of construction methods and flexible composition.
Here we create the set of visible characters using a lambda:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">struct is_visible
{
    constexpr bool operator()( char ch ) const noexcept
    {
        return ch &gt;= 33 &amp;&amp; ch &lt;= 126;
    }
};
constexpr lut_chars visible_chars( is_visible{} ); // (since C++11)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">constexpr lut_chars visible_chars(
    [](char ch) { return ch &gt;= 33 &amp;&amp; ch &lt;= 126; } ); // (since C++17)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Differences can be calculated with <code><a href="../reference/boost/urls/grammar/operator_minus.html" class="xref page">operator-</a></code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">constexpr auto visible_non_vowels = visible_chars - vowels;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can also remove individual characters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">constexpr auto visible_non_vowels_or_y = visible_chars - vowels - 'y';</code></pre>
</div>
</div>
</div>
</div>
  <div class="edit-this-page">
      <a href="https://github.com/boostorg/url/edit/develop/doc/modules/ROOT/pages/grammar/charset.adoc">Edit this Page</a>
      </div>
      <nav class="pagination">
        <span class="prev"><a href="rules.html">Parse Rules</a></span>
        <span class="next"><a href="combinators.html">Compound Rules</a></span>
    </nav>
</article>
</div>
  <div id="footer">
  <script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script async src="../../_/js/vendor/tabs.js" data-sync-storage-key="preferred-tab"></script>
</div>
</div>
  </body>
</html>
